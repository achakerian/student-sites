<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chakerian Recipes</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="cookbook-wrapper">
        <header class="cookbook-header">
            <div class="ornamental-border">
                <h1>Chakerian Recipes</h1>
                <p class="subtitle">Traditional Family Recipes Since 1892</p>
                <div class="decorative-line"></div>
            </div>
        </header>

        <nav class="recipe-tabs">
            <button class="tab active" data-category="all">All Recipes</button>
            <button class="tab" data-category="appetizers">Appetizers</button>
            <button class="tab" data-category="mains">Main Courses</button>
            <button class="tab" data-category="desserts">Desserts</button>
            <button class="tab" data-category="drinks">Beverages</button>
        </nav>

        <main class="recipe-grid" id="recipe-container">
            <!-- Recipes will be loaded dynamically from recipes.json -->
        </main>

        <footer class="cookbook-footer">
            <div class="ornamental-border">
                <p>"Cooking is love made visible" - Grandma Rose</p>
                <div class="decorative-line"></div>
            </div>
        </footer>
    </div>

    <script>
        // Load recipes from JSON file
        async function loadRecipes() {
            try {
                const response = await fetch('./recipes.json');
                const data = await response.json();
                const container = document.getElementById('recipe-container');

                container.innerHTML = data.recipes.map(recipe => `
                    <article class="recipe-card" data-category="${recipe.category}">
                        <div class="card-inner">
                            <!-- Front of card -->
                            <div class="card-front">
                                <div class="front-image">
                                    <img src="${recipe.image}" alt="${recipe.title}" loading="lazy">
                                </div>
                                <div class="front-content">
                                    <div class="front-header">
                                        <h3>${recipe.title}</h3>
                                        <span class="recipe-year">${recipe.year}</span>
                                    </div>
                                    <div class="front-footer">
                                        <span class="prep-time">${recipe.prepTime}</span>
                                        <span class="serves">${recipe.serves}</span>
                                    </div>
                                    <div class="flip-hint">Click to view recipe</div>
                                </div>
                            </div>

                            <!-- Back of card -->
                            <div class="card-back">
                                <div class="back-header">
                                    <h3>${recipe.title}</h3>
                                    <button class="flip-back-btn">← Back</button>
                                </div>
                                <div class="recipe-content">
                                    <div class="recipe-main">
                                        <div class="ingredients">
                                            <h4>Ingredients:</h4>
                                            <div class="checklist">
                                                ${recipe.ingredients.map((ingredient, index) => `
                                                    <div class="checklist-item">
                                                        <input type="checkbox" id="ingredient-${recipe.id}-${index}" class="ingredient-checkbox">
                                                        <label for="ingredient-${recipe.id}-${index}">${ingredient}</label>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>
                                        <div class="instructions">
                                            <h4>Instructions:</h4>
                                            <div class="instruction-steps">
                                                ${recipe.instructions.map((instruction, index) => `
                                                    <div class="step-item">
                                                        <div class="step-content">
                                                            <span class="step-number">${instruction.step}.</span>
                                                            <span class="step-text">${instruction.text}</span>
                                                        </div>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nutrition-info" data-recipe-id="${recipe.id}">
                                        <div class="nutrition-header">
                                            <h4 class="nutrition-title">Nutrition Per Serving</h4>
                                            <button class="nutrition-toggle" title="Click to toggle between per serving and total recipe">
                                                <span class="toggle-icon">⇄</span>
                                            </button>
                                        </div>
                                        <div class="serving-size">
                                            <span class="serving-label">Serving Size:</span>
                                            <span class="serving-value">${recipe.servingSize}</span>
                                        </div>
                                        <div class="nutrition-item">
                                            <span class="nutrition-label">Calories</span>
                                            <span class="nutrition-value" data-per-serving="${recipe.nutrition.calories}" data-total="${recipe.nutrition.calories * 12}">${recipe.nutrition.calories}</span>
                                        </div>
                                        <div class="nutrition-item">
                                            <span class="nutrition-label">Protein</span>
                                            <span class="nutrition-value" data-per-serving="${recipe.nutrition.protein}" data-total="${(parseFloat(recipe.nutrition.protein) * 12).toFixed(2)}g">${recipe.nutrition.protein}</span>
                                        </div>
                                        <div class="nutrition-item">
                                            <span class="nutrition-label">Carbs</span>
                                            <span class="nutrition-value" data-per-serving="${recipe.nutrition.carbs}" data-total="${(parseFloat(recipe.nutrition.carbs) * 12).toFixed(2)}g">${recipe.nutrition.carbs}</span>
                                        </div>
                                        <div class="nutrition-item">
                                            <span class="nutrition-label">Fat</span>
                                            <span class="nutrition-value" data-per-serving="${recipe.nutrition.fat}" data-total="${(parseFloat(recipe.nutrition.fat) * 12).toFixed(2)}g">${recipe.nutrition.fat}</span>
                                        </div>
                                        <div class="nutrition-item">
                                            <span class="nutrition-label">Sugar</span>
                                            <span class="nutrition-value" data-per-serving="${recipe.nutrition.sugar}" data-total="${(parseFloat(recipe.nutrition.sugar) * 12).toFixed(2)}g">${recipe.nutrition.sugar}</span>
                                        </div>
                                        <div class="nutrition-item">
                                            <span class="nutrition-label">Fiber</span>
                                            <span class="nutrition-value" data-per-serving="${recipe.nutrition.fiber}" data-total="${(parseFloat(recipe.nutrition.fiber) * 12).toFixed(2)}g">${recipe.nutrition.fiber}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>
                `).join('');

                // Initialize tab functionality and card flips after recipes are loaded
                initializeTabs();
                initializeCardFlips();
                initializeNutritionToggle();
            } catch (error) {
                console.error('Error loading recipes:', error);
                document.getElementById('recipe-container').innerHTML = '<p>Error loading recipes.</p>';
            }
        }

        // Tab functionality
        function initializeTabs() {
            const tabs = document.querySelectorAll('.tab');
            const recipes = document.querySelectorAll('.recipe-card');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove active class from all tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');

                    const category = tab.dataset.category;

                    // Show/hide recipes based on category
                    recipes.forEach(recipe => {
                        if (category === 'all' || recipe.dataset.category === category) {
                            recipe.style.display = 'block';
                        } else {
                            recipe.style.display = 'none';
                        }
                    });
                });
            });
        }

        // Card flip functionality
        function initializeCardFlips() {
            const cards = document.querySelectorAll('.recipe-card');

            cards.forEach(card => {
                const cardFront = card.querySelector('.card-front');
                const flipBackBtn = card.querySelector('.flip-back-btn');

                // Flip to back when clicking front
                cardFront.addEventListener('click', () => {
                    card.classList.add('flipped');
                });

                // Flip to front when clicking back button
                flipBackBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    card.classList.remove('flipped');
                });
            });
        }

        // Nutrition toggle functionality
        function initializeNutritionToggle() {
            const nutritionInfos = document.querySelectorAll('.nutrition-info');

            nutritionInfos.forEach(nutritionInfo => {
                const toggleBtn = nutritionInfo.querySelector('.nutrition-toggle');
                const nutritionValues = nutritionInfo.querySelectorAll('.nutrition-value');
                let showingTotal = false;

                toggleBtn.addEventListener('click', () => {
                    showingTotal = !showingTotal;

                    if (showingTotal) {
                        nutritionInfo.classList.add('show-total');
                        nutritionValues.forEach(value => {
                            value.textContent = value.dataset.total;
                        });
                    } else {
                        nutritionInfo.classList.remove('show-total');
                        nutritionValues.forEach(value => {
                            value.textContent = value.dataset.perServing;
                        });
                    }
                });
            });
        }

        // Load recipes when page loads
        document.addEventListener('DOMContentLoaded', loadRecipes);
    </script>
</body>
</html>